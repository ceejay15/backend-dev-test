var vows = require('vows');
var BufferList = require('../');
var assert = require('assert');

var list = new BufferList();
list.push(new Buffer(''));
list.push(new Buffer('a'));
list.push(new Buffer('bc'));
list.slice(1,10,function(){});

list.purge(1);

vows.describe('buffer-list/indexOf').addBatch({
    "BufferList's #purge": {
        topic: function () {
            this.list = list;
            this.callback();
        },
        "should remove everything before an index": function () {
            assert.equal(this.list.indexOf(new Buffer('bc')), 0);
            assert.equal(this.list.queries[0].args[0], 0);
            assert.equal(this.list.queries[0].args[1], 9);
            assert.equal(this.list.buffers.length, 1);
        }
    }
}).export(module)